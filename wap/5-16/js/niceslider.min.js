"use strict";!function(t){function i(i){return t.extend({},P,i)}function e(i){t.extend(D,i)}function n(t){var i=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||setTimeout)(t);return i}function s(t){return(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||clearTimeout)(t),null}function h(t){function i(){f._at=n(function(){l=+new Date-u,a=(D[f.cfg.animation]||D.linear)(l,e,c,o),V(r,a,d),l>=o?(s(f._at),V(r,h,d),t.cb&&t.cb.apply(f),f._isAni=!1,f.cfg.onChange&&f.cfg.onChange.apply(f)):i()})}var e=t.start||0,h=t.end||0,r=t.dom,o=t.time,c=h-e,a=e,u=+new Date,l=0,d=this.isVertical,f=this;this._at&&s(this._at),this._isAni=!0,i()}function r(){this._isAni&&(s(this._at),this._isAni=!1,y.apply(this))}function o(t,i,e){h.call(this,{dom:this.jBox,start:t,end:i,time:"number"==typeof e?e:300,cb:y})}function c(t,i){var e=this;this.jPrev=t.on(_.click,function(){e.prev()}),this.jNext=i.on(_.click,function(){e.next()})}function a(){var i=0,e=(this.jItem,this.stepLength),n='<ol class="slider-steps">',s=this.cfg.indexFormat,h=this,r=null;this.cfg;for(i;e>i;i++)n+='<li class="step">'+(s?s.call(h,i):i)+"</li>";n+="</ol>",this.jWrap.append(n),r=this.cfg.indexBind?this.jWrap.find(".slider-steps").on(_.click,".step",function(){var i=t(this);if(!i.hasClass("disable")){var e=r.find(".step").index(r.find(".current"))-r.find(".step").index(i);h.moveTo(h.currentIndex-e)}}):this.jWrap.find(".slider-steps"),this.jSteps=r}function u(){var t,i,e,n,s,h,r,o,u,l='<div class="slider-wrapper"><div class="slider-content"></div></div>',d=this.cfg,f=null,m=1,p="h"!==d.dir;this.isVertical=p,this.jWrap?(f=this.fragmentDom.clone(!0),this.jWrap.after(f),this.jWrap.remove(),delete this.jWrap,this.jBox=f):(f=this.jBox,this.fragmentDom=f.clone(!0)),f.wrap(l),this.jWrap=i=f.closest(".slider-wrapper"),this.jItem=t=f.children(),this.jContent=e=i.find(".slider-content"),d.ctrlBtn&&(i.append('<div class="slider-control"><span class="prev"><span class="prev-s"></span></span><span class="next"><span class="next-s"></span></span></div>'),c.call(this,i.find(".prev"),i.find(".next")),this.jCtrl=this.jWrap.find(".slider-control")),t.length>1?(n=t.width(),s=t.height(),d.unlimit&&(f.append(t.clone()),m=2,2===t.length&&(f.append(t.clone()),m=3),this.jItem=t=f.children()),o=t.length/m,p?(this.jItem.height(s),f.height(s*t.length),u=Math.ceil(s*t.length/m),e.width(f.width()).height(s),r=u-this.jWrap.height()+d.offset,this.current=d.index*s):(this.jItem.width(n),f.width(n*t.length),u=Math.ceil(n*t.length/m),e.height(f.height()),h=u-this.jWrap.width()+d.offset,this.current=d.index*n),this.wrapperSize=p?i.height():i.width(),this.itemSize=p?s:n,this.moveUnit=d.unit>0?this.itemSize*d.unit:this.wrapperSize,this.scope=p?r:h,this.stepLength=d.unit>0?Math.round(this.scope/this.moveUnit+1):Math.round(this.itemSize*o/this.wrapperSize),d.unlimit&&d.unit&&(this.stepLength+=Math.round((this.wrapperSize-d.offset-this.itemSize)/this.moveUnit)),d.indexBtn&&a.apply(this),this.moveTo(d.index,0)):(n=t.width(),s=t.height(),o=1,this.wrapperSize=p?i.height():i.width(),this.itemSize=p?s:n,this.moveUnit=0,this.scope=0,this.stepLength=1,p?(f.height(s),e.width(f.width()),r=0,i.addClass("slider-no-effect"),this.current=0,this.moveTo(0,0)):(f.width(n),e.height(f.height()),h=0,i.addClass("slider-no-effect"),this.current=0,this.moveTo(0,0)))}function l(t){r.apply(this),this.touched=!0,U=H(t),q=!1,E=!1,R=0,X=0,Q.push(this),B&&this.timer&&clearTimeout(this.timer)}function d(t){Y=Q[0],Y&&Y.cfg.drag&&!Y.checkLock()?Y.touched&&(Y.timer&&clearTimeout(Y.timer),F=H(t),p.call(Y,Y.isVertical?F.y-U.y:F.x-U.x),q&&t.preventDefault()):Q.shift()}function f(t){Y=Y||Q[0]||null,Y&&(Y.cfg.drag&&(U={},F={},q&&g.apply(Y),Y.touched=!1,q=!1),k.apply(Y),Y.moveDist=0),Y=null,Q=[]}function m(t,i){if(this.isVertical&&Math.abs(t)>Math.abs(i)||!this.isVertical&&Math.abs(i)>Math.abs(t)){if(Q.shift(),Q.length)return Y=Q[0],void m.call(Y,t,i);q=!1,this.touched=!1}else q=!0;E=!0}function p(t){return E?(R=t>0,R&&this.checkLockPrev()&&(t=0),!R&&this.checkLockNext()&&(t=0),X=t,void v.call(this,t)):void m.call(this,F.x-U.x,F.y-U.y)}function v(t){var i=this.isVertical,e=this.current,n=this.scope,t=e+t;this.cfg.bounce||this.cfg.unlimit||(t=Math.min(0,Math.max(t,-1*n))),V(this.jBox,t,i),this.moveDist=t}function g(){var t=(this.isVertical,this.currentIndex),i=this.moveUnit,e=(this.jItem.length,this.stepLength,Math.abs(X)),n=0;0!==R&&(this.cfg.unlimit?R?this.prev():this.next():(e>i/4&&(n=(R?-1:1)*Math.ceil(e/i)),t+=n,t=Math.max(0,Math.min(t,this.stepLength-1)),this.moveTo(t)))}function x(){var t=this.currentIndex,i=this.cfg,e=this.stepLength,n=this.jPrev,s=this.jNext;i.unlimit?1===e&&(n.addClass("disable"),s.addClass("disable")):(0===t?n.addClass("disable"):n.removeClass("disable"),t===e-1?s.addClass("disable"):s.removeClass("disable"))}function w(){var t=this.currentIndex,i=(this.cfg,this.stepLength);this.jPrev,this.jNext;this.jSteps.find(".step").removeClass("current").eq(t%i).addClass("current")}function j(){return this.currentIndex%this.stepLength}function k(){var t=this,i=this.cfg;i.autoPlay&&(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){var i=t.currentIndex+1;t.cfg.unlimit?t.moveTo(i):(i%=t.stepLength,t.moveTo(i)),k.apply(t)},this.cfg.duration))}function y(){var t,i,e;this.cfg.unlimit&&!this.touched&&(t=this.currentIndex,i=this.stepLength,e=Math.ceil(this.jItem.length*this.itemSize/this.moveUnit),i>1&&(1>=t?(t=i+1,this.setIndexTo(t)):t>=e-2&&(t=e-2-i,this.setIndexTo(t))))}function T(t,i){var e=(this.isVertical,this.jItem.length),n=this.moveUnit,s=this.scope,h=this.cfg.offset,r=this.stepLength,c=0;return this.cfg.unlimit?r>1?(0>=t?(t=r,this.setIndexTo(t+1)):t>=e-1&&(t=e-1-r,this.setIndexTo(t-1)),c=-1*t*n+h):(t=0,c=h):(t%=e,c=Math.max(-1*t*n+h,-1*s)),o.call(this,this.touched?this.moveDist:this.current,c,this.cfg.noAnimate?0:i),this.currentIndex=t,this.current=c,this.jSteps&&w.apply(this),this.cfg.ctrlBtn&&x.apply(this),k.apply(this),this}function I(t){var i,e=this.isVertical,n=(this.jWrap,this.stepLength,this.moveUnit),s=this.cfg.offset;if("NaN"!==t.toString())return i=-1*t*n+s,V(this.jBox,i,e),this.currentIndex=t,this.current=i,this}function b(){var t=this.currentIndex-1,i=this.checkLock()||this.checkLockPrev();if(!i){if(this.cfg.unlimit)this.moveTo(t);else{if(0>t)return;this.moveTo(t)}return this}}function L(){var t=this.currentIndex+1,i=this.checkLock()||this.checkLockNext();if(!i){if(this.cfg.unlimit)this.moveTo(t);else{if(t>=this.stepLength)return;this.moveTo(t)}return this}}function M(e){return this.cfg=i(t.extend(this.cfg,{index:this.currentIndex},e)),this.timer&&clearTimeout(this.timer),G--,W.apply(this),this}function C(){var t="";this.jWrap.off().remove(),this.timer&&clearTimeout(this.timer);for(t in this)delete this[t];this.__proto__=null,G--,0===G&&z()}function S(){var i=this;this.jContent.on(_.start,function(t){l.call(i,t)}),Z||(t(document).on(_.move,d).on(_.end,f).on(_.cancel,f),!B&&this.jWrap.hover(function(){i.timer&&clearTimeout(i.timer)},function(){k.apply(i)}),Z=!0)}function z(){t(document).off(_.move,d).off(_.end,f).off(_.cancel,f),Z=!1}function W(){this.currentIndex=this.cfg.index,this.cfg.extendAnimate&&e(this.cfg.extendAnimate),u.apply(this),S.apply(this),k.apply(this),G++}function A(e,n){function s(){return f}function h(){return f=!0,this}function r(){return f=!1,this}function o(){return m}function c(){return p}function a(){return m=!0,this}function u(){return m=!1,this}function l(){return p=!0,this}function d(){return p=!1,this}this.jBox=t(e),this.cfg=i(n||{});var f=!1;this.checkLock=s,this.lock=h,this.unlock=r;var m=!1,p=!1;return this.checkLockPrev=o,this.lockPrev=a,this.unlockPrev=u,this.checkLockNext=c,this.lockNext=l,this.unlockNext=d,W.apply(this),this}var B="ontouchend"in document,_={click:"click",start:B?"touchstart":"mousedown",move:B?"touchmove":"mousemove",end:B?"touchend":"mouseup",cancel:B?"touchcancel":"mousecancel"},N=function(){var t=document.createElement("div"),i=t.style,e="";return""===i.WebkitTransform?e="-webkit-":""===i.MozTransform?e="-moz-":""===i.MsTransform&&(e="-ms-"),e}(),P={unlimit:!0,ctrlBtn:!0,indexBtn:!0,unit:1,offset:0,index:0,dir:"h",autoPlay:!1,duration:5e3,bounce:!0,drag:!0,indexBind:!0,noAnimate:!1,animation:"ease-out-back"},V=function(t,i,e){var n={};B?(e?n[N+"transform"]="translate3d(0, "+i+"px, 0)":n[N+"transform"]="translate3d("+i+"px, 0, 0)",t.css(n)):(e?n.top=i+"px":n.left=i+"px",t.css(n))},D={"ease-out-back":function(t,i,e,n){var s=1.70158;return e*((t=t/n-1)*t*((s+1)*t+s)+1)+i},linear:function(t,i,e,n){return t/n*e+i}},U={},F={},q=!1,E=!1,R=!0,X=0,Y=null,Q=[],Z=!1,G=0,H=function(t){var i,e,t=t.originalEvent?t.originalEvent:t,n=t.touches;return n?(i=n[0].pageX,e=n[0].pageY):(i=t.clientX,e=t.clientY),{x:i,y:e}};A.prototype={prev:b,next:L,setIndexTo:I,moveTo:T,getIndex:j,refresh:M,destroy:C},"function"==typeof define&&define.amd?define([],function(){return A}):"undefined"!=typeof module&&module.exports?module.exports=A:window.NiceSlider=A}(window.jQuery||window.Zepto);